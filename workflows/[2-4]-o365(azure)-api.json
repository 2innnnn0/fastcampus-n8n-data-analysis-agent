{"createdAt":"2025-07-24T07:06:49.181Z","updatedAt":"2025-09-19T06:15:20.710Z","id":"TMdxqop3P49FWwHd","name":"[2-4] O365(Azure) API","active":false,"isArchived":false,"nodes":[{"parameters":{},"type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[0,0],"id":"345dacbf-8f1b-4a06-bf7f-8cb8824852b5","name":"When clicking ‘Execute workflow’"},{"parameters":{"site":{"__rl":true,"mode":"list","value":""},"requestOptions":{}},"type":"n8n-nodes-base.microsoftSharePoint","typeVersion":1,"position":[400,0],"id":"88ea51eb-257b-4b8e-b05e-209f53d08301","name":"Download file","credentials":{"microsoftSharePointOAuth2Api":{"id":"JbQDGN495m9VBEgY","name":"Microsoft SharePoint account"}}},{"parameters":{"operation":"download"},"type":"n8n-nodes-base.microsoftOneDrive","typeVersion":1,"position":[400,176],"id":"3c8378ed-ec81-4bda-a763-a74f5b59455f","name":"Download a file"},{"parameters":{"operation":"get","teamId":{"__rl":true,"mode":"list","value":""},"channelId":{"__rl":true,"mode":"list","value":""}},"type":"n8n-nodes-base.microsoftTeams","typeVersion":2,"position":[208,176],"id":"59c842d4-a621-4609-a785-e1c0b6ac8e4f","name":"Get channel","webhookId":"49870862-65f6-412f-a04a-51eeb4f64366"},{"parameters":{"resource":"worksheet","workbook":{"__rl":true,"mode":"list","value":""},"filters":{}},"type":"n8n-nodes-base.microsoftExcel","typeVersion":2.1,"position":[208,0],"id":"edf49182-b35d-454e-ab9d-d6a6aa21d7ff","name":"Get sheets","credentials":{"microsoftExcelOAuth2Api":{"id":"5Yn5bsSc2kKQ15TM","name":"Microsoft Excel account - DP"}}},{"parameters":{"operation":"getAll","returnAll":true,"options":{}},"type":"n8n-nodes-base.microsoftOutlook","typeVersion":2,"position":[208,-176],"id":"d94d2121-8b71-442e-9154-be75271ae927","name":"Get many messages","webhookId":"0bd0ff39-16cf-4f5b-8276-5b8eb516c0fc","credentials":{"microsoftOutlookOAuth2Api":{"id":"WAN6zY1Uu6OTWnlH","name":"Microsoft Outlook account"}}},{"parameters":{"content":"![](https://raw.githubusercontent.com/2innnnn0/assets/refs/heads/master/image/datapopcorn_logo_50px.png)\n## [Microsoft 365 (Azure) API](https://wikidocs.net/291148)\n### O365(Azure) API란?\n- O365(Azure) API는 Microsoft Graph를 통해 Outlook, Teams, OneDrive, SharePoint, Calendar 등 Microsoft 365 서비스와 Azure 리소스에 프로그래밍 방식으로 접근할 수 있게 해주는 API입니다. n8n에서 Microsoft API와 연동하여 메일 전송, 파일 관리, 일정 처리, 사용자 관리 등 자동화를 구현할 수 있습니다.\n\n### 주요 기능\n- Outlook: 메일 읽기, 전송, 일정 관리\n- Teams: 메시지 전송, 채널/대화 관리\n- OneDrive/SharePoint: 파일 업로드, 다운로드, 공유\n- Calendar: 일정 생성, 조회, 업데이트\n- 사용자 및 그룹 관리 (Azure AD)\n\n### 1. Azure 계정 생성 \n- [Azure Portal](https://portal.azure.com) 접속\n- Microsoft 계정으로 로그인 후 구독 생성\n\n### 2. 앱 등록\n- Azure Portal → **Azure Active Directory**\n- **앱 등록(App registrations)** → **새 등록(New registration)**\n- 앱 이름 입력 (예: \"n8n Integration\")\n- 리디렉션 URI에 n8n OAuth Redirect URL 입력\n- 생성 완료 후 **Application (client) ID**와 **Directory (tenant) ID** 확인\n\n### 3. 클라이언트 시크릿 발급\n- 앱 등록 → **Certificates & secrets**\n- **New client secret** 클릭 → 설명과 만료 기간 입력\n- 생성된 **Client Secret** 값 복사\n\n### 4. 권한(Scopes) 설정\n- 앱 등록 → **API permissions**\n- Microsoft Graph 권한 추가\n  ``` 필수 권한 예시:\n  ✅ Mail.ReadWrite - 메일 읽기/쓰기\n  ✅ Calendars.ReadWrite - 일정 읽기/쓰기\n  ✅ Files.ReadWrite - 파일 읽기/쓰기\n  ✅ User.Read - 사용자 기본 프로필 읽기","height":992,"width":480},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-528,-448],"id":"ffe32e16-d4c3-488f-a7f5-f021d107e114","name":"Sticky Note"}],"connections":{"When clicking ‘Execute workflow’":{"main":[[{"node":"Get sheets","type":"main","index":0}]]},"Download file":{"main":[[]]},"Download a file":{"main":[[]]},"Get sheets":{"main":[[]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{},"versionId":"30293dc9-4e9d-41cb-b14e-b0d8e0e432b2","triggerCount":0,"shared":[{"createdAt":"2025-07-24T07:06:49.181Z","updatedAt":"2025-07-24T07:06:49.181Z","role":"workflow:owner","workflowId":"TMdxqop3P49FWwHd","projectId":"sjNgDrdbhRMMF6SK"}],"tags":[{"createdAt":"2025-06-25T04:00:38.130Z","updatedAt":"2025-09-19T05:46:22.728Z","id":"EyGUZypc5DKHVUyY","name":"패스트캠퍼스_관리자"}]}