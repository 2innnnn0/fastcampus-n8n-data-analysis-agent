{"createdAt":"2025-09-03T02:55:57.107Z","updatedAt":"2025-09-10T10:52:04.876Z","id":"Tdq94Bmn3h8zFFLK","name":"자동차 리콜 데이터 리포트","active":false,"isArchived":false,"nodes":[{"parameters":{"promptType":"define","text":"={{ $json.body.recallData }}","options":{"systemMessage":"입력받은 정보를 차량리콜 리포트로 만들어줘."}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.2,"position":[-1184,1696],"id":"84fabf1b-8ad6-44d4-9cb0-a40850d7f9db","name":"AI Agent"},{"parameters":{"model":{"__rl":true,"value":"gpt-4.1-mini","mode":"list","cachedResultName":"gpt-4.1-mini"},"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[-1232,1920],"id":"30330b5e-465d-4663-840f-1e96679863f5","name":"OpenAI Chat Model"},{"parameters":{"html":"<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n  <meta charset=\"UTF-8\" />\n  <title>차량 리콜 보고서</title>\n  <style>\n    @page { size: A4; margin: 12mm; }\n    body {\n      font-family: 'Noto Sans KR', system-ui, sans-serif;\n      margin:0; background:#fff; color:#222; font-size:13pt; line-height:1.55;\n    }\n    .container { max-width: 185mm; margin: 0 auto; padding: 10mm; }\n    .header { display:flex; justify-content:space-between; align-items:flex-end; }\n    .title { font-size:22pt; margin:0; color:#1f2937; }\n    .date { font-size:11pt; color:#666; }\n    hr { border:0; height:2px; background:linear-gradient(90deg,#0f6fdb,#7cc4ff); margin:6mm 0; }\n\n    /* 요약 섹션 */\n    .summary { margin-bottom: 8mm; }\n    .summary p { margin:0 0 3mm; }\n    .bullets { margin:0; padding-left:16px; font-size:12.5pt; }\n    .bullets li { margin-bottom:2mm; }\n\n    /* 핵심 정보 카드 */\n    .facts {\n      border:1px solid #e5e7eb; border-radius:10px; padding:6mm; margin-bottom:8mm;\n      background:#fafafa;\n    }\n    .facts h2 { font-size:14pt; margin-top:0; color:#34495e; }\n    .kv { display:grid; grid-template-columns:30mm 1fr; row-gap:4mm; font-size:12pt; }\n    .kv dt { color:#555; }\n    .kv dd { margin:0; font-weight:600; }\n\n    /* 심각도 뱃지 */\n    .sev { display:inline-block; padding:2px 10px; border-radius:999px; font-size:11pt; font-weight:700; }\n    .sev.high { background:#fee2e2; color:#b91c1c; }\n    .sev.med { background:#fef3c7; color:#92400e; }\n    .sev.low { background:#dcfce7; color:#166534; }\n\n    /* 이미지 */\n    .figure { text-align:center; margin-top:8mm; }\n    .figure img { max-width:100%; height:auto; max-height:90mm; border:1px solid #eee; border-radius:8px; padding:4px; }\n    .caption { font-size:10pt; color:#666; margin-top:4px; }\n\n    /* 푸터 */\n    .footer { display:flex; justify-content:space-between; font-size:10pt; color:#666; margin-top:8mm; }\n    .badge { color:#195fbf; background:#eaf3ff; border:1px solid #cfe7ff; padding:2px 6px; border-radius:6px; }\n  </style>\n</head>\n<body>\n  <div class=\"container\">\n    <!-- 헤더 -->\n    <div class=\"header\">\n      <h1 class=\"title\">차량 리콜 보고서</h1>\n      <div class=\"date\">\n        {{ $json.reportDate || (new Date()).toISOString().slice(0,10) }}\n      </div>\n    </div>\n    <hr/>\n\n    <!-- 요약문 + bullet -->\n    <div class=\"summary\">\n      <p>\n        {{\n          (function(){\n            const raw = ($json.textOutput || '');\n            const clean = raw.replace(/[*#`]/g,'').split('[이미지 확인]')[0];\n            const sents = clean.split(/[.?!]\\s+/).filter(Boolean);\n            return sents.slice(0,2).join('. ') + '.';\n          })()\n        }}\n      </p>\n      <ul class=\"bullets\">\n        <li>주요 위험: 변속 케이블 브라켓 체결 불량</li>\n        <li>잠재 영향: 변속 레버 작동 불능 → 안전사고 위험</li>\n        <li>조치 계획: 리콜 점검 및 무상 수리</li>\n      </ul>\n    </div>\n\n    <!-- 핵심 정보 -->\n    <div class=\"facts\">\n      <h2>리콜 개요</h2>\n      <dl class=\"kv\">\n        <dt>제조사</dt><dd>현대자동차(주)</dd>\n        <dt>차종</dt><dd>포터2 (HR)</dd>\n        <dt>기간</dt><dd>2023-03-07 ~ 2023-03-08</dd>\n        <dt>개시일</dt><dd>2023-04-10</dd>\n        <dt>리콜 ID</dt><dd>포터2(HR)-2023-04-10</dd>\n        <dt>심각도</dt><dd><span class=\"sev med\">중간</span></dd>\n      </dl>\n    </div>\n\n    <!-- 시각자료 -->\n    <div class=\"figure\">\n      {{\n        (function(){\n          const img = $json.imageData || '';\n          if(!img) return `<div style=\"border:1px dashed #ccc; padding:20mm; color:#888;\">시각 자료 없음</div>`;\n          const src = img.startsWith('data:') ? img : `data:image/png;base64,${img}`;\n          return `<img src=\"${src}\" alt=\"리콜 데이터 시각화\">`;\n        })()\n      }}\n      <div class=\"caption\">그림 1. 리콜 데이터 시각화</div>\n    </div>\n\n    <!-- 푸터 -->\n    <div class=\"footer\">\n      <span class=\"badge\">자동 생성 · n8n + GPT + Gotenberg</span>\n      <span>문의: data-team@example.com</span>\n    </div>\n  </div>\n</body>\n</html>\n"},"type":"n8n-nodes-base.html","typeVersion":1.2,"position":[-608,1696],"id":"4611d4df-1a58-4d2a-a5fe-701764f99301","name":"HTML"},{"parameters":{"assignments":{"assignments":[{"id":"2561942e-b531-4019-b328-e1bb0ed2511b","name":"textOutput","value":"={{ $json.output }}","type":"string"},{"id":"cf6d3ea0-a254-4261-9e7c-e3805c987c85","name":"imageData","value":"={{ $('Webhook').item.json.body.visualizationImage }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-832,1696],"id":"45ada119-c8dd-4508-8f0f-0b639477b62e","name":"Edit Fields"},{"parameters":{"method":"POST","url":"http://host.docker.internal:3000/forms/chromium/convert/html","sendBody":true,"contentType":"multipart-form-data","bodyParameters":{"parameters":[{"parameterType":"formBinaryData","name":"files","inputDataFieldName":"data"}]},"options":{"response":{"response":{"responseFormat":"file"}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-160,1696],"id":"998504b4-cd8f-4a8a-b417-afe7c11710b2","name":"convert to pdf"},{"parameters":{"operation":"toText","sourceProperty":"html","binaryPropertyName":"=data","options":{"fileName":"index.html"}},"type":"n8n-nodes-base.convertToFile","typeVersion":1.1,"position":[-384,1696],"id":"5977fbb8-1aa0-414f-acf0-c9c54093add0","name":"Convert to File"},{"parameters":{"content":"## TRIGGER\n","height":208,"width":208,"color":7},"type":"n8n-nodes-base.stickyNote","position":[-1472,1648],"typeVersion":1,"id":"8d406d75-a97c-48bc-8b17-0ea05637fe81","name":"Sticky Note1"},{"parameters":{"content":"- AI가 입력 데이터를 분석하고, 요약/리포트 형태로 작성.  \n- OpenAI GPT 모델이 연결되어 있으며, 프롬프트를 통해 자동으로 텍스트 리포트를 생성.\n","height":144,"width":214,"color":5},"type":"n8n-nodes-base.stickyNote","position":[-1072,1568],"typeVersion":1,"id":"731f2c34-4a09-4b41-a1c2-baabb183bbd5","name":"Sticky Note3"},{"parameters":{"content":"- 리포트에 포함할 변수들을 설정하는 노드.\n- 'AI가 생성해준 텍스트'와 '웹훅으로 넘겨받은 시각화 정보 데이트'로 구분해주는 노드\n\n","height":144,"width":166,"color":5},"type":"n8n-nodes-base.stickyNote","position":[-784,1568],"typeVersion":1,"id":"f17bc7ce-609f-4d97-bf30-6324bddea787","name":"Sticky Note4"},{"parameters":{"content":"- AI가 만든 텍스트를 HTML 템플릿으로 변환.  \n- 리포트가 보기 좋은 형태로 구성되도록 HTML 구조를 설정.\n","height":144,"width":160,"color":5},"type":"n8n-nodes-base.stickyNote","position":[-576,1568],"typeVersion":1,"id":"38be931a-ab86-433a-afee-b06ab25b339f","name":"Sticky Note5"},{"parameters":{"content":"Docker에 설치된 Gotenberg 서버를 이용해 HTML을 PDF로 변환합니다.  \nGotenberg는 API 기반 오픈소스 PDF 변환기이며, 이 워크플로우는 HTTP 요청으로 변환을 요청합니다.\n\n🛠 Gotenberg 서버는 Docker에서 실행되고 있어야 하며,\nn8n은 http://host.docker.internal:3000 같은 주소로 요청을 보냅니다.\n","height":256,"width":256,"color":5},"type":"n8n-nodes-base.stickyNote","position":[-336,1552],"typeVersion":1,"id":"460ef16e-f227-4295-9c13-d458dc00f283","name":"Sticky Note6"},{"parameters":{"content":"# 리콜 알림 발송\n\n\n","height":768,"width":912,"color":7},"type":"n8n-nodes-base.stickyNote","position":[-1248,672],"typeVersion":1,"id":"c25c084d-f469-4cf3-9d33-975b35ae2684","name":"Sticky Note8"},{"parameters":{"fieldToSplitOut":"data","options":{}},"type":"n8n-nodes-base.splitOut","typeVersion":1,"position":[-736,640],"id":"23917e3d-06fb-4881-a0ed-40a70e2b17da","name":"Split Out"},{"parameters":{"tableId":"recall_data_test_2","fieldsUi":{"fieldValues":[{"fieldId":"recall_date","fieldValue":"={{ $json['리콜개시일'] }}"},{"fieldId":"recall_reason","fieldValue":"={{ $json['리콜사유'] }}"},{"fieldId":"production(to)","fieldValue":"={{ $json['생산기간(까지)'] }}"},{"fieldId":"production(from)","fieldValue":"={{ $json['생산기간(부터)'] }}"},{"fieldId":"maker","fieldValue":"={{ $json['제작자'] }}"},{"fieldId":"model","fieldValue":"={{ $json['차명'] }}"}]}},"type":"n8n-nodes-base.supabase","typeVersion":1,"position":[-288,736],"id":"a1eac110-f5d8-4be2-aa41-a6143590ae0c","name":"Supabase DB 연동"},{"parameters":{"compare":"selectedFields","fieldsToCompare":"['이메일']","options":{}},"type":"n8n-nodes-base.removeDuplicates","typeVersion":2,"position":[-736,1280],"id":"97f6e01f-98e1-4be3-97c2-021575c0f2d0","name":"중복 이메일 제거"},{"parameters":{"operation":"append","documentId":{"__rl":true,"value":"1u7a27P4M3r3sIZ-kNeg-S3qnGZ0yx0UrKSUALGn-VmE","mode":"list","cachedResultName":"자동차 리콜 정보 ","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1u7a27P4M3r3sIZ-kNeg-S3qnGZ0yx0UrKSUALGn-VmE/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"Recall","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1u7a27P4M3r3sIZ-kNeg-S3qnGZ0yx0UrKSUALGn-VmE/edit#gid=0"},"columns":{"mappingMode":"autoMapInputData","value":{},"matchingColumns":[],"schema":[{"id":"리콜개시일","displayName":"리콜개시일","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"리콜사유","displayName":"리콜사유","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"생산기간(까지)","displayName":"생산기간(까지)","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"생산기간(부터)","displayName":"생산기간(부터)","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"제작자","displayName":"제작자","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"차명","displayName":"차명","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.6,"position":[-512,640],"id":"f11ca109-c8b8-4f55-a3a3-5198113f695c","name":"'Recall'시트에 적재"},{"parameters":{"operation":"append","documentId":{"__rl":true,"value":"1u7a27P4M3r3sIZ-kNeg-S3qnGZ0yx0UrKSUALGn-VmE","mode":"list","cachedResultName":"Recall_data","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1u7a27P4M3r3sIZ-kNeg-S3qnGZ0yx0UrKSUALGn-VmE/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":1577570114,"mode":"list","cachedResultName":"Customer","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1u7a27P4M3r3sIZ-kNeg-S3qnGZ0yx0UrKSUALGn-VmE/edit#gid=1577570114"},"columns":{"mappingMode":"defineBelow","value":{"이메일":"={{ $json['이메일'] }}","car model":"={{ $json['차량명'] }}","purchase date":"={{ $json['구매일자'] }}"},"matchingColumns":[],"schema":[{"id":"car model","displayName":"car model","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"purchase date","displayName":"purchase date","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"이메일","displayName":"이메일","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"submittedAt","displayName":"submittedAt","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"formMode","displayName":"formMode","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"차량명","displayName":"차량명","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"구매일자","displayName":"구매일자","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.6,"position":[-1184,960],"id":"42e31d4d-49fe-46fa-ad29-15f580ccb9b7","name":"'Customer' 시트에 적재"},{"parameters":{"documentId":{"__rl":true,"value":"1u7a27P4M3r3sIZ-kNeg-S3qnGZ0yx0UrKSUALGn-VmE","mode":"list","cachedResultName":"Recall_data","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1u7a27P4M3r3sIZ-kNeg-S3qnGZ0yx0UrKSUALGn-VmE/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":1577570114,"mode":"list","cachedResultName":"Customer","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1u7a27P4M3r3sIZ-kNeg-S3qnGZ0yx0UrKSUALGn-VmE/edit#gid=1577570114"},"options":{}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.6,"position":[-1184,1280],"id":"1276bb6a-be20-4fa7-bb8c-52bf277124d4","name":"2_Customer","executeOnce":true,"credentials":{"googleSheetsOAuth2Api":{"id":"LUHbrnvA5uAuGJG7","name":"Sehee"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"194d97e2-1018-47fa-ad6b-b99f9e1c29bc","leftValue":"={{ $('1_Recall').item.json['리콜개시일'] }}","rightValue":"={{ $json['purchase date'] }}","operator":{"type":"dateTime","operation":"after"}},{"id":"b7ce0c44-7529-4958-ba70-8f69e095a994","leftValue":"={{ $('1_Recall').item.json['차명'] }}","rightValue":"={{ $json['car model'] }}","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-960,1280],"id":"f5b137ef-288f-4261-b729-09964235d1b7","name":"두 시트 비교","executeOnce":false,"retryOnFail":false,"alwaysOutputData":false},{"parameters":{"rule":{"interval":[{"field":"weeks","triggerAtDay":[1],"triggerAtHour":9}]}},"type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[-1408,640],"id":"6701a28e-6faf-46bf-a4ff-0e6d375d85eb","name":"매일 9am"},{"parameters":{"operation":"clear","documentId":{"__rl":true,"value":"1u7a27P4M3r3sIZ-kNeg-S3qnGZ0yx0UrKSUALGn-VmE","mode":"list","cachedResultName":"Recall_data","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1u7a27P4M3r3sIZ-kNeg-S3qnGZ0yx0UrKSUALGn-VmE/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"Recall","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1u7a27P4M3r3sIZ-kNeg-S3qnGZ0yx0UrKSUALGn-VmE/edit#gid=0"}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.7,"position":[-1184,640],"id":"ce9d3461-e0bb-490c-aa52-2c6e1f3f4408","name":"중복 제거"},{"parameters":{"sendTo":"={{ $json['이메일'] }}","subject":"CAR RECALL ALARM","emailType":"text","message":"=- 차종 : {{ $('1_Recall').item.json['차명'] }}\n- 리콜사유 : {{ $('1_Recall').item.json['리콜사유'] }}\n- 생산기간 : {{ $('1_Recall').item.json['생산기간(부터)'] }} ~ {{ $('1_Recall').item.json['생산기간(까지)'] }}","options":{}},"type":"n8n-nodes-base.gmail","typeVersion":2.1,"position":[-512,1184],"id":"599bc41b-b7fd-4308-93bb-7e581e535a34","name":"메일 발송","webhookId":"16dee804-6922-41f4-8a82-5861c28ffcb0"},{"parameters":{"formTitle":"차량 정보 입력","formDescription":"차량 정보를 입력하세요","formFields":{"values":[{"fieldLabel":"차량명","placeholder":"옵티머스프라임","requiredField":true},{"fieldLabel":"구매일자","fieldType":"date","requiredField":true},{"fieldLabel":"이메일","fieldType":"email","placeholder":"test@naver.com","requiredField":true}]},"options":{}},"type":"n8n-nodes-base.formTrigger","typeVersion":2.2,"position":[-1408,960],"id":"3e36ad44-1186-48fd-93cc-d074c8ef65c3","name":"사용자 정보 입력","webhookId":"fb7fdd6f-9166-4e3f-9d29-a45e717d0fb8"},{"parameters":{"pollTimes":{"item":[{"hour":9}]},"documentId":{"__rl":true,"value":"1u7a27P4M3r3sIZ-kNeg-S3qnGZ0yx0UrKSUALGn-VmE","mode":"list","cachedResultName":"자동차 리콜 정보 ","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1u7a27P4M3r3sIZ-kNeg-S3qnGZ0yx0UrKSUALGn-VmE/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"Recall","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1u7a27P4M3r3sIZ-kNeg-S3qnGZ0yx0UrKSUALGn-VmE/edit#gid=0"},"event":"rowAdded","options":{}},"type":"n8n-nodes-base.googleSheetsTrigger","typeVersion":1,"position":[-1408,1280],"id":"10f2b7e6-8372-49dd-bf41-b1f892d3b5f8","name":"1_Recall","credentials":{"googleSheetsTriggerOAuth2Api":{"id":"OEujjIdCg8ygfn56","name":"Google Sheets Trigger account"}}},{"parameters":{"operation":"delete","tableId":"recall_data_test_2","matchType":"allFilters","filters":{"conditions":[{"keyName":"recall_date","condition":"eq","keyValue":"={{ $json['리콜개시일'] }}"},{"keyName":"recall_reason","condition":"eq","keyValue":"={{ $json['리콜사유'] }}"},{"keyName":"maker","condition":"eq","keyValue":"={{ $json['제작자'] }}"},{"keyName":"model","condition":"eq","keyValue":"={{ $json['차명'] }}"}]}},"type":"n8n-nodes-base.supabase","typeVersion":1,"position":[-288,544],"id":"f22fb0ca-d577-4701-84d0-3a7040b8474e","name":"중복제거"},{"parameters":{"content":"## 리콜 데이터 수집","height":224,"width":880,"color":7},"type":"n8n-nodes-base.stickyNote","position":[-1440,592],"typeVersion":1,"id":"557dc2fe-8712-4ca1-a18e-29bca0f19e1e","name":"Sticky Note"},{"parameters":{"content":"## 사용자 데이터 수집","height":224,"width":480,"color":7},"type":"n8n-nodes-base.stickyNote","position":[-1456,896],"typeVersion":1,"id":"a83b6e3a-ad43-47b0-bcc4-987c7de37e78","name":"Sticky Note10"},{"parameters":{"content":"## 리콜 알림 메일 발송","height":256,"width":1168,"color":7},"type":"n8n-nodes-base.stickyNote","position":[-1472,1200],"typeVersion":1,"id":"2af34dfc-200d-4a21-8b51-80f79a9f5761","name":"Sticky Note11"},{"parameters":{"public":true,"initialMessages":"안녕하세요. 저는 차량 리콜 정보 조회를 전문으로 하는 AI Agent입니다.\n\n특정 차량의 리콜 정보를 확인하고 싶거나, 궁금한 점이 있으시면 언제든지 말씀해주세요.\n\n","options":{"subtitle":"안녕하세요! 차량 리콜 정보를 알려드리는 챗봇입니다. 무엇이든 물어보세요!","title":"AI Car Recall 🤖"}},"type":"@n8n/n8n-nodes-langchain.chatTrigger","typeVersion":1.1,"position":[-1408,208],"id":"fe975122-3367-45ee-981a-b7886908726b","name":"When chat message received","webhookId":"6352f430-ab04-4667-9b06-b5b523a47d32"},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.toolSerpApi","typeVersion":1,"position":[-928,432],"id":"b6d6d4b8-75fd-495f-8c81-088ed64b363b","name":"SerpAPI"},{"parameters":{"hasOutputParser":true,"options":{"systemMessage":"={\n  \"role\": \"자동차 리콜 전문가 AI\",\n  \"task\": \"자동차 리콜 요약 보고서 작성\",\n  \"input_field\": \"차명\",\n  \"data_source\": \"Supabase\",\n  \"output_fields\": [\n    \"리콜 사유\",\n    \"리콜 개시일\",\n    \"생산기간 (시작 ~ 종료)\",\n    \"제작자\"\n  ],\n  \"no_data_message\": \"해당 차량에 대한 리콜 정보가 없습니다.\",\n  \"language\": \"한국어\",\n  \"style\": \"이해하기 쉬운 문장으로 요약\"\n}\n\n추가적으로, 차명이 완전히 일치하지 않더라도 2글자 이상 일치하면 해당 리콜 건에 대해 대답해줘.\n\n너가 가져올 supabase의 DB의 칼럼명은 'recall_date', 'recall_reason', 'production(from)', 'production(to)', 'maker', 'model'로 되어 있을 거야.\n컬렴이 어디에 매핑되는지는 알아서 추론 가능할 거라고 생각해. 잘 부탁해. \n"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.1,"position":[-1008,208],"id":"6faf989e-db77-4ddf-b344-2db2d46395d3","name":"AI Agent1"},{"parameters":{},"type":"@n8n/n8n-nodes-langchain.memoryBufferWindow","typeVersion":1.3,"position":[-1056,432],"id":"0c747701-98a7-431c-9437-317d0da7b16b","name":"Simple Memory"},{"parameters":{"model":{"__rl":true,"mode":"list","value":"gpt-4.1-mini"},"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[-1184,432],"id":"408214d0-8d3a-4149-a749-98d5cedb64aa","name":"OpenAI"},{"parameters":{"httpMethod":"POST","path":"=recall","options":{}},"type":"n8n-nodes-base.webhook","typeVersion":2,"position":[-1424,1696],"id":"181ec094-63f2-4254-a06f-38ef15eb903d","name":"Webhook","webhookId":"398f98fe-c58a-4f20-b553-87e5832009ca","executeOnce":false,"retryOnFail":false},{"parameters":{"sendTo":"={{ $('Webhook').item.json.body.email }}","subject":"Recall Report","emailType":"text","message":"안녕하세요. 리콜보고서 보내드립니다.","options":{"attachmentsUi":{"attachmentsBinary":[{}]}}},"type":"n8n-nodes-base.gmail","typeVersion":2.1,"position":[96,1696],"id":"89b95262-5e45-488a-8701-6c86e3faebad","name":"리포트 발송","webhookId":"9310b498-3e8a-4f97-92fe-417899878b52"},{"parameters":{"content":"# 리콜 리포트 발송","height":304,"width":1728,"color":7},"type":"n8n-nodes-base.stickyNote","position":[-1472,1552],"typeVersion":1,"id":"121361be-ad6d-4ee7-a2c0-ed8bcb532ef9","name":"Sticky Note14"},{"parameters":{"content":"# 리콜 챗봇","height":480,"width":912,"color":7},"type":"n8n-nodes-base.stickyNote","position":[-1440,80],"typeVersion":1,"id":"c2120103-3dc3-4546-8e5d-781ac6894e39","name":"Sticky Note15"},{"parameters":{},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.3,"position":[-672,432],"id":"6d093ff4-1623-4346-b3d4-df821742c038","name":"Structured Output Parser"},{"parameters":{"content":"## TASK\n","height":208,"width":1104,"color":7},"type":"n8n-nodes-base.stickyNote","position":[-1184,1648],"typeVersion":1,"id":"2dc0dca3-3d14-4545-8c34-e22789554034","name":"Sticky Note16"},{"parameters":{"content":"## TARGET\n","height":208,"width":224,"color":7},"type":"n8n-nodes-base.stickyNote","position":[0,1648],"typeVersion":1,"id":"217715cd-f09f-40f4-b062-655c79692dd5","name":"Sticky Note17"},{"parameters":{"method":"POST","url":"https://kapi.kakao.com/v2/api/talk/memo/default/send","authentication":"genericCredentialType","genericAuthType":"oAuth2Api","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Content-Type","value":"application/x-www-form-urlencoded;charset=utf-8"}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"template_object","value":"={\n  \"object_type\": \"text\",\n  \"text\": \"안녕하세요! 리콜 안내봇입니다.\\n고객님의 차량({{ $json['car model'] }})에 대한 리콜 정보가 확인되어 알려드립니다.\\n\\n구매일자: {{ $json['purchase date'] }}\\n\\n자세한 내용은 자동차 리콜센터 웹사이트를 참고해주세요.\\n\\n리콜 챗봇 바로가기:\\nhttps://d2bc4b92c08a.ngrok-free.app/webhook/6352f430-ab04-4667-9b06-b5b523a47d32/chat\"\n,\n  \"link\": {\n    \"web_url\": \"https://www.car.go.kr/vehicle/RecallSearch.jsp\",\n    \"mobile_web_url\": \"https://www.car.go.kr/vehicle/RecallSearch.jsp\"\n  },\n  \"buttons\": [\n    {\n      \"title\": \"자세히 보기\",\n      \"link\": {\n        \"web_url\": \"https://www.car.go.kr/vehicle/RecallSearch.jsp\",\n        \"mobile_web_url\": \"https://www.car.go.kr/vehicle/RecallSearch.jsp\"\n      }\n    }\n  ]\n}\n"},{}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-512,1376],"id":"17a23047-854a-41c9-a53e-db9da80408cb","name":"카카오톡 발송"},{"parameters":{"url":"=https://api.odcloud.kr/api/3048950/v1/uddi:096d9d09-883c-4027-be00-b0915d273ce5","sendQuery":true,"queryParameters":{"parameters":[{"name":"page","value":"1"},{"name":"perPage","value":"30"},{"name":"serviceKey","value":"jVwm8WYdMpGK4BqfwpN6eZvd0gaG5oJ5HihWrIhNwhaEdvvtLZHVaChaUQh8fO5GaWlRqxFROPnItSiO7/lf+A=="}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"accept","value":"*/*"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-960,640],"id":"20659d58-9ea0-4c32-b0b0-a64590b2baf2","name":"국토교통부_리콜API 호출"},{"parameters":{"operation":"get","tableId":"recall_data_test_2","filters":{"conditions":[{"keyName":"model","keyValue":"={{ $json.chatInput }}"}]}},"type":"n8n-nodes-base.supabaseTool","typeVersion":1,"position":[-800,432],"id":"3ce1263f-c8e4-460f-abdd-c65a976510b6","name":"Supabase DB"}],"connections":{"AI Agent":{"main":[[{"node":"Edit Fields","type":"main","index":0}]]},"OpenAI Chat Model":{"ai_languageModel":[[{"node":"AI Agent","type":"ai_languageModel","index":0}]]},"HTML":{"main":[[{"node":"Convert to File","type":"main","index":0}]]},"Edit Fields":{"main":[[{"node":"HTML","type":"main","index":0}]]},"convert to pdf":{"main":[[{"node":"리포트 발송","type":"main","index":0}]]},"Convert to File":{"main":[[{"node":"convert to pdf","type":"main","index":0}]]},"Split Out":{"main":[[{"node":"'Recall'시트에 적재","type":"main","index":0}]]},"중복 이메일 제거":{"main":[[{"node":"메일 발송","type":"main","index":0},{"node":"카카오톡 발송","type":"main","index":0}]]},"'Recall'시트에 적재":{"main":[[{"node":"중복제거","type":"main","index":0},{"node":"Supabase DB 연동","type":"main","index":0}]]},"2_Customer":{"main":[[{"node":"두 시트 비교","type":"main","index":0}]]},"두 시트 비교":{"main":[[{"node":"중복 이메일 제거","type":"main","index":0}]]},"매일 9am":{"main":[[{"node":"중복 제거","type":"main","index":0}]]},"중복 제거":{"main":[[{"node":"국토교통부_리콜API 호출","type":"main","index":0}]]},"사용자 정보 입력":{"main":[[{"node":"'Customer' 시트에 적재","type":"main","index":0}]]},"1_Recall":{"main":[[{"node":"2_Customer","type":"main","index":0}]]},"When chat message received":{"main":[[{"node":"AI Agent1","type":"main","index":0}]]},"SerpAPI":{"ai_tool":[[{"node":"AI Agent1","type":"ai_tool","index":0}]]},"Simple Memory":{"ai_memory":[[{"node":"AI Agent1","type":"ai_memory","index":0}]]},"OpenAI":{"ai_languageModel":[[{"node":"AI Agent1","type":"ai_languageModel","index":0}]]},"Webhook":{"main":[[{"node":"AI Agent","type":"main","index":0}]]},"Structured Output Parser":{"ai_outputParser":[[{"node":"AI Agent1","type":"ai_outputParser","index":0}]]},"국토교통부_리콜API 호출":{"main":[[{"node":"Split Out","type":"main","index":0}]]},"Supabase DB":{"ai_tool":[[{"node":"AI Agent1","type":"ai_tool","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{},"versionId":"89168bbd-ae1d-43ca-a637-014ae0f9c805","triggerCount":0,"shared":[{"createdAt":"2025-09-03T02:55:57.107Z","updatedAt":"2025-09-03T02:55:57.107Z","role":"workflow:owner","workflowId":"Tdq94Bmn3h8zFFLK","projectId":"sjNgDrdbhRMMF6SK"}],"tags":[{"createdAt":"2025-06-25T04:00:38.130Z","updatedAt":"2025-06-25T04:00:38.130Z","id":"EyGUZypc5DKHVUyY","name":"패스트캠퍼스"}]}